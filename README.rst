Based on code from Sean Robertson, adapted to word level as in the original paper
